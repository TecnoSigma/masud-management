<%= render './././partials/messages' %>
<div class="col-lg-12">
  <div class="card mb-8">
    <div class="card-header">
      <i class="fas fa-chart-pie me-1"></i>
      Pie Chart Example
    </div>
    <div class="card-body"><canvas id="myPieChart" width="100%" height="50"></canvas></div>
    <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
  </div>
</div>
  <script>
    $(document).on('turbolinks:load', function() {
        loadCharts();
    });

    function loadCharts() {
        $.ajax({
                url: "/gestao/admin/dashboard/graficos/escorts_by_status",
                type: "GET",
                data: {},
                success: function(data, status, xhr) {
                        populateChart(data.chart_data.statuses, data.chart_data.quantities, data.chart_data.colors);
                },
                error: function(xhr, status, error) {
                        console.log(error);
                }
        });
    }

    function populateChart(labels, data, backgroundColor){
        var fonts = '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';

        Chart.defaults.global.defaultFontFamily = fonts;
        Chart.defaults.global.defaultFontColor = '#292b2c';

        var ctx = document.getElementById("myPieChart");
        var myPieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                        labels: labels,
                        datasets: [{
                                data: data,
                                backgroundColor: backgroundColor,
                        }],
                },
        });
    }
</script>
